### **Техническое Задание: Рефакторинг Системы Подписок CryptoCaller**

**Статус: РЕАЛИЗОВАНО**

**1. Общее описание и цель**

Целью данного рефакторинга является полный отказ от существующей небезопасной и нефункционирующей системы псевдо-подписок и переход на криптографически верифицируемую on-chain модель. Смарт-контракт `SubscriptionContract` должен стать единственным источником истины о статусе подписки пользователя.

---

**2. Требования к Бэкенду**

2.1. **Полное удаление устаревшего модуля `tickets`**. 
    - [x] Все файлы, относящиеся к `tickets` (`controller`, `service`, `entity`, `module`), удалены.
    - [x] Связь с `TicketModule` в главном модуле приложения `app.module.ts` устранена.

2.2. **Реализация нового модуля `Subscription` для верификации подписок.**
    - [x] Создан новый модуль `SubscriptionModule` со своим контроллером и сервисом.
    - [x] `SubscriptionService` содержит метод `checkSubscription(walletAddress: string)`, который обращается к блокчейну TON.
    - [x] Метод `checkSubscription` вызывает getter-функцию `isSubscribed(address)` смарт-контракта `SubscriptionContract`.
    - [x] `SubscriptionController` предоставляет `GET` эндпоинт `/api/subscription/:walletAddress`.
    - [x] `SubscriptionController` предоставляет `GET` эндпоинт `/api/subscription/config`.

---

**3. Требования к Фронтенду**

3.1. **Интеграция со смарт-контрактом.**
    - [x] Логика покупки подписки полностью переработана в `SubscriptionForm.js` и `apiService.js`.
    - [x] При покупке, фронтенд запрашивает конфигурацию (`/api/subscription/config`) у бэкенда.
    - [x] Фронтенд формирует и отправляет транзакцию на адрес смарт-контракта.
    - [x] В `Dashboard.js` реализован механизм опроса эндпоинта `/api/subscription/:walletAddress` для подтверждения транзакции.

---

**4. Требования к Конфигурации (ЗАДАЧА ПОЛЬЗОВАТЕЛЯ)**

4.1. **Переменные окружения.**
    - [ ] В `.env` файле бэкенда должна быть добавлена переменная `SUBSCRIPTION_CONTRACT_ADDRESS`, содержащая актуальный адрес развернутого смарт-контракта.
    - [ ] В `.env` файле бэкенда должна быть добавлена переменная `SUBSCRIPTION_PRICE` (например, `0.75`), которая будет использоваться для конфигурации фронтенда.

---

## V. Что предстоит сделать (Задачи пользователя)

Все работы по модификации кода завершены. Для полноценного запуска системы необходимо выполнить следующие действия:

1.  **Развернуть смарт-контракт:** Скомпилировать и развернуть контракт `SubscriptionContract` в основной сети TON (mainnet).
2.  **Настроить окружение:** После получения адреса контракта, необходимо **обязательно** прописать следующие переменные в `.env` файле в директории `backend/`:
    - `SUBSCRIPTION_CONTRACT_ADDRESS=<АДРЕС_ВАШЕГО_КОНТРАКТА>`
    - `SUBSCRIPTION_PRICE=<ЦЕНА_ПОДПИСКИ_В_TON>`
